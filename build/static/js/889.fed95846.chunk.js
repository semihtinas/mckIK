"use strict";(self.webpackChunkmuse_dashboard=self.webpackChunkmuse_dashboard||[]).push([[889],{889:(e,s,a)=>{a.r(s),a.d(s,{default:()=>l});var r=a(9950),t=a(9246),o=a(8429),i=a(5376),n=a(4414);const l=function(e){let{setAuthState:s}=e;const[a,l]=(0,r.useState)({username:"",password:""}),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(!1),h=(0,o.Zp)(),p=e=>{const{name:s,value:a}=e.target;l((e=>({...e,[s]:a})))};return(0,n.jsx)("div",{className:"login-page",children:(0,n.jsxs)("div",{className:"login-form",children:[(0,n.jsx)("h2",{className:"text-center",children:"Giri\u015f Yap"}),(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),c(""),m(!0);try{const e=(await t.A.post("http://localhost:5001/api/login",a)).data.token;if(!e)throw new Error("Token al\u0131namad\u0131");localStorage.setItem("token",e);const[r,o]=await Promise.all([t.A.get("http://localhost:5001/api/permissions/user-permissions",{headers:{Authorization:`Bearer ${e}`}}),t.A.get("http://localhost:5001/api/me",{headers:{Authorization:`Bearer ${e}`}})]);s({isAuthenticated:!0,isLoading:!1,userInfo:o.data,userPermissions:r.data.permissions||[],isPermissionsLoaded:!0}),h("/dashboard",{replace:!0})}catch(d){console.error("Login error:",d);let a="Giri\u015f ba\u015far\u0131s\u0131z";var r;if(d.response)a=(null===(r=d.response.data)||void 0===r?void 0:r.message)||a;else a=d.request?"Sunucuya ba\u011flan\u0131lamad\u0131":d.message;c(a),s({isAuthenticated:!1,isLoading:!1,userInfo:null,userPermissions:[],isPermissionsLoaded:!0}),localStorage.removeItem("token")}finally{m(!1)}},children:[(0,n.jsx)("div",{className:"form-group",children:(0,n.jsx)("input",{type:"text",name:"username",placeholder:"Kullan\u0131c\u0131 Ad\u0131",value:a.username,onChange:p,disabled:u,required:!0,className:"form-control"})}),(0,n.jsx)("div",{className:"form-group",children:(0,n.jsx)("input",{type:"password",name:"password",placeholder:"\u015eifre",value:a.password,onChange:p,disabled:u,required:!0,className:"form-control"})}),d&&(0,n.jsx)("div",{className:"error-message",children:d}),(0,n.jsx)("button",{type:"submit",disabled:u,className:"login-button "+(u?"loading":""),children:u?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.A,{size:"small"}),(0,n.jsx)("span",{children:"Giri\u015f yap\u0131l\u0131yor..."})]}):"Giri\u015f Yap"})]})]})})}}}]);